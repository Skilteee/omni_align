[2025-10-12 23:01:19 root] (main.py 281): INFO Namespace(model='meta-llama/Llama-2-7b-chat-hf', cache_dir='./cache', output_dir='./log/Llama-2-7b-chat-w4a4g128', save_dir=None, resume=None, real_quant=False, calib_dataset='wikitext2', nsamples=128, batch_size=1, seqlen=128, seed=2, tasks='', eval_ppl=True, num_fewshot=0, wbits=8, abits=8, group_size=None, alpha=0.5, let_lr=0.001, lwc_lr=0.01, wd=0, epochs=5, let=True, lwc=True, aug_loss=False, symmetric=False, disable_zero_point=False, a_dynamic_method='per_token', w_dynamic_method='per_channel', limit=-1, multigpu=False, deactive_amp=True, attn_implementation='eager', net=None, act_scales=None, act_shifts=None)
[2025-10-12 23:01:34 root] (main.py 346): INFO === start quantization ===
[2025-10-12 23:01:35 root] (omniquant.py 53): INFO Starting ...
[2025-10-12 23:01:40 root] (omniquant.py 225): INFO === Start quantize layer 0 ===
[2025-10-12 23:02:09 root] (omniquant.py 347): INFO layer 0 iter 0 loss:0.4469253122806549 norm:0.6781776547431946 reconstruction:2.275800966344832e-06 attack:0.33565937843173743 margin:0.5563182227770449
[2025-10-12 23:02:31 root] (omniquant.py 347): INFO layer 0 iter 1 loss:0.3265642523765564 norm:0.41012054681777954 reconstruction:2.6843811269827713e-06 attack:0.21310000509023666 margin:0.5673078318929765
[2025-10-12 23:02:54 root] (omniquant.py 347): INFO layer 0 iter 2 loss:0.3139042258262634 norm:0.35805806517601013 reconstruction:2.7176094545211525e-06 attack:0.20783438187092543 margin:0.53033561021266
[2025-10-12 23:03:16 root] (omniquant.py 347): INFO layer 0 iter 3 loss:0.29845157265663147 norm:0.3171861469745636 reconstruction:2.783363333946909e-06 attack:0.20412093859165906 margin:0.47163914887702046
[2025-10-12 23:03:39 root] (omniquant.py 347): INFO layer 0 iter 4 loss:0.2881278693675995 norm:0.27442896366119385 reconstruction:2.8497321864051626e-06 attack:0.2016179595142603 margin:0.43253522748826073
[2025-10-12 23:03:47 root] (omniquant.py 225): INFO === Start quantize layer 1 ===
[2025-10-12 23:04:15 root] (omniquant.py 347): INFO layer 1 iter 0 loss:0.7343911528587341 norm:0.37299472093582153 reconstruction:0.0010783824799000285 attack:0.5643022890016437 margin:0.8450526079584961
[2025-10-12 23:04:38 root] (omniquant.py 347): INFO layer 1 iter 1 loss:0.39294764399528503 norm:0.1885501891374588 reconstruction:0.0002325625992671121 attack:0.24099564880132676 margin:0.7585970292870479
[2025-10-12 23:05:01 root] (omniquant.py 347): INFO layer 1 iter 2 loss:0.3728469908237457 norm:0.17473861575126648 reconstruction:0.000239996753516607 attack:0.22343507640063762 margin:0.7458593497872971
[2025-10-12 23:05:23 root] (omniquant.py 347): INFO layer 1 iter 3 loss:0.3520263731479645 norm:0.16245119273662567 reconstruction:0.00022013738736859523 attack:0.21286885682493448 margin:0.694686848636702
[2025-10-12 23:05:46 root] (omniquant.py 347): INFO layer 1 iter 4 loss:0.3322997987270355 norm:0.15003639459609985 reconstruction:0.0001868512071087025 attack:0.21180142097175123 margin:0.6015576484650228
[2025-10-12 23:05:54 root] (omniquant.py 225): INFO === Start quantize layer 2 ===
[2025-10-12 23:06:22 root] (omniquant.py 347): INFO layer 2 iter 0 loss:0.5003308653831482 norm:0.15277759730815887 reconstruction:0.00015665273313061334 attack:0.4341743039339781 margin:0.3299998288583265
[2025-10-12 23:06:45 root] (omniquant.py 347): INFO layer 2 iter 1 loss:0.33010512590408325 norm:0.09501948207616806 reconstruction:0.00016008967082598247 attack:0.21502199655398727 margin:0.5746152827620972
[2025-10-12 23:07:07 root] (omniquant.py 347): INFO layer 2 iter 2 loss:0.31849873065948486 norm:0.11716638505458832 reconstruction:0.00015715676374384202 attack:0.20132949996739627 margin:0.5850603623408824
[2025-10-12 23:07:30 root] (omniquant.py 347): INFO layer 2 iter 3 loss:0.3110501170158386 norm:0.10480561852455139 reconstruction:0.0001568605528154876 attack:0.20852892372757195 margin:0.5118216263745319
[2025-10-12 23:07:52 root] (omniquant.py 347): INFO layer 2 iter 4 loss:0.3052207827568054 norm:0.09669801592826843 reconstruction:0.00015677599250921048 attack:0.20646642416715622 margin:0.49298784017708386
[2025-10-12 23:08:00 root] (omniquant.py 225): INFO === Start quantize layer 3 ===
[2025-10-12 23:08:31 root] (omniquant.py 347): INFO layer 3 iter 0 loss:0.3737885355949402 norm:0.161114901304245 reconstruction:0.0001685348863247782 attack:0.30145657632499934 margin:0.36081695978304196
[2025-10-12 23:08:55 root] (omniquant.py 347): INFO layer 3 iter 1 loss:0.31835463643074036 norm:0.1031714603304863 reconstruction:0.00016895581167773345 attack:0.20163009725511075 margin:0.5827780290861847
[2025-10-12 23:09:17 root] (omniquant.py 347): INFO layer 3 iter 2 loss:0.31648939847946167 norm:0.10655517876148224 reconstruction:0.00016890863451408223 attack:0.2072132382914424 margin:0.5455362699289981
[2025-10-12 23:09:40 root] (omniquant.py 347): INFO layer 3 iter 3 loss:0.31028109788894653 norm:0.09739723056554794 reconstruction:0.00016907699377043171 attack:0.20390117067843674 margin:0.5310541120549896
[2025-10-12 23:10:05 root] (omniquant.py 347): INFO layer 3 iter 4 loss:0.3050347566604614 norm:0.09328827261924744 reconstruction:0.00016928065830143168 attack:0.2046026149764657 margin:0.5013143644560478
[2025-10-12 23:10:13 root] (omniquant.py 225): INFO === Start quantize layer 4 ===
[2025-10-12 23:10:41 root] (omniquant.py 347): INFO layer 4 iter 0 loss:0.5679228901863098 norm:0.12269831448793411 reconstruction:0.00021082784835016355 attack:0.50413349583745 margin:0.3178929998044623
[2025-10-12 23:11:04 root] (omniquant.py 347): INFO layer 4 iter 1 loss:0.3103884756565094 norm:0.05493942275643349 reconstruction:0.0002277727190812584 attack:0.22655991576611995 margin:0.4180040327929055
[2025-10-12 23:11:27 root] (omniquant.py 347): INFO layer 4 iter 2 loss:0.29623711109161377 norm:0.04705054685473442 reconstruction:0.00022339167044265195 attack:0.19901065908372403 margin:0.4850153813115321
[2025-10-12 23:11:50 root] (omniquant.py 347): INFO layer 4 iter 3 loss:0.2935991585254669 norm:0.04544937238097191 reconstruction:0.00022110095815151 attack:0.20242734603583812 margin:0.45475355559145103
[2025-10-12 23:12:12 root] (omniquant.py 347): INFO layer 4 iter 4 loss:0.29086726903915405 norm:0.043820369988679886 reconstruction:0.00021990078515955248 attack:0.20155350651592016 margin:0.4454693685790698
[2025-10-12 23:12:18 root] (omniquant.py 225): INFO === Start quantize layer 5 ===
[2025-10-12 23:12:47 root] (omniquant.py 347): INFO layer 5 iter 0 loss:0.7765278816223145 norm:0.12843623757362366 reconstruction:0.0002449956294731237 attack:0.6473710019886494 margin:0.6445592630078317
[2025-10-12 23:13:13 root] (omniquant.py 347): INFO layer 5 iter 1 loss:0.3658556342124939 norm:0.06365423649549484 reconstruction:0.0002830733972950838 attack:0.2931920426338911 margin:0.36190255862980847
[2025-10-12 23:13:37 root] (omniquant.py 347): INFO layer 5 iter 2 loss:0.31419259309768677 norm:0.0485185906291008 reconstruction:0.00029230734071461484 attack:0.20006198704242706 margin:0.5691914842618371
[2025-10-12 23:13:59 root] (omniquant.py 347): INFO layer 5 iter 3 loss:0.3064386248588562 norm:0.044506367295980453 reconstruction:0.00029069104144582527 attack:0.20292425774037837 margin:0.5161184499197407
[2025-10-12 23:14:23 root] (omniquant.py 347): INFO layer 5 iter 4 loss:0.2967836856842041 norm:0.038249436765909195 reconstruction:0.00029557388712419196 attack:0.19744754377752544 margin:0.49520272836402457
[2025-10-12 23:14:31 root] (omniquant.py 225): INFO === Start quantize layer 6 ===
[2025-10-12 23:15:02 root] (omniquant.py 347): INFO layer 6 iter 0 loss:0.4133082628250122 norm:0.0853361189365387 reconstruction:0.0003826650540577248 attack:0.37713521778583525 margin:0.17895177719105504
[2025-10-12 23:15:26 root] (omniquant.py 347): INFO layer 6 iter 1 loss:0.3013342618942261 norm:0.045115675777196884 reconstruction:0.0003865178592968732 attack:0.22013173062354327 margin:0.40408000480226064
[2025-10-12 23:15:49 root] (omniquant.py 347): INFO layer 6 iter 2 loss:0.29592078924179077 norm:0.04396028816699982 reconstruction:0.0003873784258030355 attack:0.20188329193741084 margin:0.4682506825524615
[2025-10-12 23:16:12 root] (omniquant.py 347): INFO layer 6 iter 3 loss:0.29423579573631287 norm:0.041561320424079895 reconstruction:0.00038650056172627955 attack:0.20289591550827027 margin:0.45476694315948407
[2025-10-12 23:16:35 root] (omniquant.py 347): INFO layer 6 iter 4 loss:0.2918289303779602 norm:0.03963952511548996 reconstruction:0.0003865749615943059 attack:0.2001710832118988 margin:0.45635628805411216
[2025-10-12 23:16:42 root] (omniquant.py 225): INFO === Start quantize layer 7 ===
[2025-10-12 23:17:11 root] (omniquant.py 347): INFO layer 7 iter 0 loss:0.5099645256996155 norm:0.12636823952198029 reconstruction:0.0004462909518042579 attack:0.44130812644958495 margin:0.3410503826849163
[2025-10-12 23:17:34 root] (omniquant.py 347): INFO layer 7 iter 1 loss:0.32493552565574646 norm:0.07950437068939209 reconstruction:0.0004582733119605109 attack:0.22795371890068053 margin:0.48261769101227403
[2025-10-12 23:17:58 root] (omniquant.py 347): INFO layer 7 iter 2 loss:0.3187304735183716 norm:0.07673618197441101 reconstruction:0.0004591077839722857 attack:0.20828197930008174 margin:0.5499468309846998
[2025-10-12 23:18:21 root] (omniquant.py 347): INFO layer 7 iter 3 loss:0.31565409898757935 norm:0.07422393560409546 reconstruction:0.0004598363654804416 attack:0.2084423039853573 margin:0.5337597294796069
[2025-10-12 23:18:44 root] (omniquant.py 347): INFO layer 7 iter 4 loss:0.31653571128845215 norm:0.07387269288301468 reconstruction:0.0004619829694274813 attack:0.20553045015782118 margin:0.5527164898872263
[2025-10-12 23:18:52 root] (omniquant.py 225): INFO === Start quantize layer 8 ===
[2025-10-12 23:19:21 root] (omniquant.py 347): INFO layer 8 iter 0 loss:0.7070345878601074 norm:0.14568552374839783 reconstruction:0.0005776965129189193 attack:0.5845859415829182 margin:0.6093549428642825
[2025-10-12 23:19:43 root] (omniquant.py 347): INFO layer 8 iter 1 loss:0.3505205512046814 norm:0.07047620415687561 reconstruction:0.0006011679372750222 attack:0.2430176663864404 margin:0.5345088360642695
[2025-10-12 23:20:05 root] (omniquant.py 347): INFO layer 8 iter 2 loss:0.34078285098075867 norm:0.06694945693016052 reconstruction:0.0006024891074048356 attack:0.2140001649223268 margin:0.6309009797219187
[2025-10-12 23:20:28 root] (omniquant.py 347): INFO layer 8 iter 3 loss:0.3378264904022217 norm:0.06597227603197098 reconstruction:0.0005995324969990178 attack:0.21175018467009069 margin:0.6273839585657697
[2025-10-12 23:20:50 root] (omniquant.py 347): INFO layer 8 iter 4 loss:0.3373247981071472 norm:0.06522282212972641 reconstruction:0.0005975987296551466 attack:0.21217530861496925 margin:0.6227594793133904
[2025-10-12 23:20:59 root] (omniquant.py 225): INFO === Start quantize layer 9 ===
[2025-10-12 23:21:30 root] (omniquant.py 347): INFO layer 9 iter 0 loss:2.916043758392334 norm:0.33905842900276184 reconstruction:0.0006767445837613195 attack:1.6676943974010647 margin:6.238363096788525
[2025-10-12 23:21:53 root] (omniquant.py 347): INFO layer 9 iter 1 loss:1.021775245666504 norm:0.1966892033815384 reconstruction:0.0009851443633669987 attack:0.6886879044468515 margin:1.6605111400937311
[2025-10-12 23:22:15 root] (omniquant.py 347): INFO layer 9 iter 2 loss:0.45744287967681885 norm:0.10176262259483337 reconstruction:0.0014655415492597968 attack:0.23291969703743234 margin:1.115288163709538
[2025-10-12 23:22:38 root] (omniquant.py 347): INFO layer 9 iter 3 loss:0.4188365936279297 norm:0.08724471926689148 reconstruction:0.0016834180138539524 attack:0.22122563920449465 margin:0.9796376422316826
[2025-10-12 23:23:00 root] (omniquant.py 347): INFO layer 9 iter 4 loss:0.3812781870365143 norm:0.07367929816246033 reconstruction:0.001896161591866985 attack:0.21091184260323645 margin:0.8423509662323341
[2025-10-12 23:23:08 root] (omniquant.py 225): INFO === Start quantize layer 10 ===
[2025-10-12 23:23:37 root] (omniquant.py 347): INFO layer 10 iter 0 loss:0.5133150219917297 norm:0.04406995326280594 reconstruction:0.0022757500573061407 attack:0.36185538792517036 margin:0.7459195053450094
[2025-10-12 23:23:59 root] (omniquant.py 347): INFO layer 10 iter 1 loss:0.45650526881217957 norm:0.042402252554893494 reconstruction:0.0022857640089932827 attack:0.2787555466545746 margin:0.8773199974745512
[2025-10-12 23:24:22 root] (omniquant.py 347): INFO layer 10 iter 2 loss:0.43824824690818787 norm:0.042670007795095444 reconstruction:0.0022922861122060567 attack:0.23873511745594442 margin:0.9861040588724427
[2025-10-12 23:24:44 root] (omniquant.py 347): INFO layer 10 iter 3 loss:0.42433181405067444 norm:0.04372618347406387 reconstruction:0.0022939718631096186 attack:0.22747130618896336 margin:0.9728326771926368
[2025-10-12 23:25:06 root] (omniquant.py 347): INFO layer 10 iter 4 loss:0.405655175447464 norm:0.04386981949210167 reconstruction:0.002294830596074462 attack:0.21749708341434598 margin:0.9293162832455709
[2025-10-12 23:25:13 root] (omniquant.py 225): INFO === Start quantize layer 11 ===
[2025-10-12 23:25:41 root] (omniquant.py 347): INFO layer 11 iter 0 loss:1.323372483253479 norm:0.12030743807554245 reconstruction:0.002407963939476758 attack:0.8923995968932286 margin:2.1428244829643517
[2025-10-12 23:26:04 root] (omniquant.py 347): INFO layer 11 iter 1 loss:0.6989423632621765 norm:0.09382900595664978 reconstruction:0.0024897698499262333 attack:0.4702822317928076 margin:1.1308519952266942
[2025-10-12 23:26:26 root] (omniquant.py 347): INFO layer 11 iter 2 loss:0.4781332314014435 norm:0.06999474763870239 reconstruction:0.0026363458624109625 attack:0.22849733964307234 margin:1.2349976966530993
[2025-10-12 23:26:49 root] (omniquant.py 347): INFO layer 11 iter 3 loss:0.44245395064353943 norm:0.06305025517940521 reconstruction:0.0026694681635126474 attack:0.21165552482940256 margin:1.1406447504693278
[2025-10-12 23:27:12 root] (omniquant.py 347): INFO layer 11 iter 4 loss:0.41239920258522034 norm:0.05818340927362442 reconstruction:0.0027139182132668795 attack:0.20660228873603045 margin:1.0154151493866654
[2025-10-12 23:27:19 root] (omniquant.py 225): INFO === Start quantize layer 12 ===
[2025-10-12 23:27:47 root] (omniquant.py 347): INFO layer 12 iter 0 loss:2.2459051609039307 norm:0.08524683117866516 reconstruction:0.002855178127065301 attack:1.3832536091282963 margin:4.298981318473816
[2025-10-12 23:28:10 root] (omniquant.py 347): INFO layer 12 iter 1 loss:1.207074761390686 norm:0.08299057185649872 reconstruction:0.0030488198390230536 attack:0.8298818357940764 margin:1.870720207125014
[2025-10-12 23:28:32 root] (omniquant.py 347): INFO layer 12 iter 2 loss:0.4054289758205414 norm:0.04531575366854668 reconstruction:0.003946042687166482 attack:0.21801068488974124 margin:0.9173612627586408
[2025-10-12 23:28:55 root] (omniquant.py 347): INFO layer 12 iter 3 loss:0.3746798038482666 norm:0.03963250666856766 reconstruction:0.003964941666927188 attack:0.2024698793143034 margin:0.8412249953394212
[2025-10-12 23:29:18 root] (omniquant.py 347): INFO layer 12 iter 4 loss:0.3501768112182617 norm:0.03458886593580246 reconstruction:0.004072062314953655 attack:0.1992142844758928 margin:0.7344521920124852
[2025-10-12 23:29:24 root] (omniquant.py 225): INFO === Start quantize layer 13 ===
[2025-10-12 23:29:52 root] (omniquant.py 347): INFO layer 13 iter 0 loss:1.245337963104248 norm:0.052912626415491104 reconstruction:0.004820202430710197 attack:0.9020317768678069 margin:1.6924299465958028
[2025-10-12 23:30:15 root] (omniquant.py 347): INFO layer 13 iter 1 loss:0.7743677496910095 norm:0.042295247316360474 reconstruction:0.004954411638900638 attack:0.5967342220060528 margin:0.8633954077070303
[2025-10-12 23:30:37 root] (omniquant.py 347): INFO layer 13 iter 2 loss:0.37029457092285156 norm:0.02621138095855713 reconstruction:0.007193542793393135 attack:0.21225122848525643 margin:0.7542490271994029
[2025-10-12 23:31:00 root] (omniquant.py 347): INFO layer 13 iter 3 loss:0.3464144170284271 norm:0.02103361301124096 reconstruction:0.008498830921016633 attack:0.19964342100545765 margin:0.6913608431019748
[2025-10-12 23:31:23 root] (omniquant.py 347): INFO layer 13 iter 4 loss:0.33051547408103943 norm:0.017926203086972237 reconstruction:0.009198925900273025 attack:0.19907576952129602 margin:0.6112039628566709
[2025-10-12 23:31:30 root] (omniquant.py 225): INFO === Start quantize layer 14 ===
[2025-10-12 23:31:59 root] (omniquant.py 347): INFO layer 14 iter 0 loss:0.4289860427379608 norm:0.019442331045866013 reconstruction:0.010510734999552369 attack:0.29120226258412 margin:0.6363651241130946
[2025-10-12 23:32:21 root] (omniquant.py 347): INFO layer 14 iter 1 loss:0.40909767150878906 norm:0.01684103161096573 reconstruction:0.010503155384212733 attack:0.2612795607186854 margin:0.6865749123436399
[2025-10-12 23:32:44 root] (omniquant.py 347): INFO layer 14 iter 2 loss:0.39479419589042664 norm:0.018335646018385887 reconstruction:0.010476738754659891 attack:0.23344812769442796 margin:0.754346631432777
[2025-10-12 23:33:07 root] (omniquant.py 347): INFO layer 14 iter 3 loss:0.37975189089775085 norm:0.018714547157287598 reconstruction:0.010508648622781037 attack:0.21152874181047082 margin:0.7885725313521499
[2025-10-12 23:33:29 root] (omniquant.py 347): INFO layer 14 iter 4 loss:0.3670715093612671 norm:0.01950846239924431 reconstruction:0.010612364402040839 attack:0.20547556357458233 margin:0.7549178121065643
[2025-10-12 23:33:37 root] (omniquant.py 225): INFO === Start quantize layer 15 ===
[2025-10-12 23:34:05 root] (omniquant.py 347): INFO layer 15 iter 0 loss:0.4489545524120331 norm:0.017956731840968132 reconstruction:0.012777036149054765 attack:0.33699435509741305 margin:0.4959158080932866
[2025-10-12 23:34:28 root] (omniquant.py 347): INFO layer 15 iter 1 loss:0.41562676429748535 norm:0.016822077333927155 reconstruction:0.012714734664186836 attack:0.29015482443384827 margin:0.56378605834675
[2025-10-12 23:34:50 root] (omniquant.py 347): INFO layer 15 iter 2 loss:0.3922557532787323 norm:0.01606159843504429 reconstruction:0.012617841698229312 attack:0.24725591166876257 margin:0.6619099273894062
[2025-10-12 23:35:13 root] (omniquant.py 347): INFO layer 15 iter 3 loss:0.37836718559265137 norm:0.016718320548534393 reconstruction:0.012598851798102259 attack:0.21957973532378675 margin:0.7309429470624673
[2025-10-12 23:35:36 root] (omniquant.py 347): INFO layer 15 iter 4 loss:0.36555877327919006 norm:0.016308896243572235 reconstruction:0.012575698606669903 attack:0.21046872334554792 margin:0.7125717423332389
[2025-10-12 23:35:44 root] (omniquant.py 225): INFO === Start quantize layer 16 ===
[2025-10-12 23:36:12 root] (omniquant.py 347): INFO layer 16 iter 0 loss:0.41245049238204956 norm:0.012996537610888481 reconstruction:0.014864092515781522 attack:0.19079592768102885 margin:1.0339523033732256
[2025-10-12 23:36:35 root] (omniquant.py 347): INFO layer 16 iter 1 loss:0.4067378640174866 norm:0.013326568529009819 reconstruction:0.01480372240766883 attack:0.19849702718667686 margin:0.9671854331072245
[2025-10-12 23:36:58 root] (omniquant.py 347): INFO layer 16 iter 2 loss:0.4014672338962555 norm:0.014154534786939621 reconstruction:0.014705110397189856 attack:0.20468278313055635 margin:0.9103966344238142
[2025-10-12 23:37:20 root] (omniquant.py 347): INFO layer 16 iter 3 loss:0.39105457067489624 norm:0.01909450627863407 reconstruction:0.01468147037550807 attack:0.21297004165127872 margin:0.8170152673573466
[2025-10-12 23:37:42 root] (omniquant.py 347): INFO layer 16 iter 4 loss:0.37809640169143677 norm:0.024264052510261536 reconstruction:0.014772044941782952 attack:0.22218008818104862 margin:0.7057210250657227
[2025-10-12 23:37:49 root] (omniquant.py 225): INFO === Start quantize layer 17 ===
[2025-10-12 23:38:18 root] (omniquant.py 347): INFO layer 17 iter 0 loss:0.871600329875946 norm:0.060687221586704254 reconstruction:0.016866414966061713 attack:0.06319938174332491 margin:3.9576727402582765
[2025-10-12 23:38:40 root] (omniquant.py 347): INFO layer 17 iter 1 loss:0.544816255569458 norm:0.062237728387117386 reconstruction:0.016418773103505372 attack:0.16373858314473183 margin:1.8232943508429162
[2025-10-12 23:39:03 root] (omniquant.py 347): INFO layer 17 iter 2 loss:0.4400346875190735 norm:0.06496883183717728 reconstruction:0.01622667889110744 attack:0.24010196356102825 margin:0.9185302337474422
[2025-10-12 23:39:26 root] (omniquant.py 347): INFO layer 17 iter 3 loss:0.4290821850299835 norm:0.06378429383039474 reconstruction:0.016202374920248987 attack:0.2420610111951828 margin:0.8540937609730735
[2025-10-12 23:39:48 root] (omniquant.py 347): INFO layer 17 iter 4 loss:0.4143695831298828 norm:0.06154046952724457 reconstruction:0.016188617767766117 attack:0.2383215876389295 margin:0.7992969274837788
[2025-10-12 23:39:55 root] (omniquant.py 225): INFO === Start quantize layer 18 ===
[2025-10-12 23:40:25 root] (omniquant.py 347): INFO layer 18 iter 0 loss:0.5683992505073547 norm:0.02480180747807026 reconstruction:0.024157179035246373 attack:0.1203316125459969 margin:2.1195526792487724
[2025-10-12 23:40:47 root] (omniquant.py 347): INFO layer 18 iter 1 loss:0.4963596761226654 norm:0.03139249607920647 reconstruction:0.023959873616695403 attack:0.16129905306734144 margin:1.5555035559357202
[2025-10-12 23:41:10 root] (omniquant.py 347): INFO layer 18 iter 2 loss:0.44281744956970215 norm:0.05034676939249039 reconstruction:0.023663761261850595 attack:0.22762987306341528 margin:0.9576190238818526
[2025-10-12 23:41:32 root] (omniquant.py 347): INFO layer 18 iter 3 loss:0.421724408864975 norm:0.0493570901453495 reconstruction:0.02311328310519457 attack:0.23889939658343792 margin:0.7985585245342373
[2025-10-12 23:41:55 root] (omniquant.py 347): INFO layer 18 iter 4 loss:0.4029727876186371 norm:0.04708562418818474 reconstruction:0.022662355117499828 attack:0.236458029858768 margin:0.7192620663993875
[2025-10-12 23:42:02 root] (omniquant.py 225): INFO === Start quantize layer 19 ===
[2025-10-12 23:42:30 root] (omniquant.py 347): INFO layer 19 iter 0 loss:0.7363790273666382 norm:0.03833716735243797 reconstruction:0.02539901252835989 attack:0.07894141033058986 margin:3.1601929780468345
[2025-10-12 23:42:53 root] (omniquant.py 347): INFO layer 19 iter 1 loss:0.5556671619415283 norm:0.04532574117183685 reconstruction:0.025540195740759372 attack:0.14471225707326085 margin:1.9270734477695077
[2025-10-12 23:43:15 root] (omniquant.py 347): INFO layer 19 iter 2 loss:0.44984883069992065 norm:0.06593156605958939 reconstruction:0.02584569938480854 attack:0.2256212447397411 margin:0.991909496974331
[2025-10-12 23:43:39 root] (omniquant.py 347): INFO layer 19 iter 3 loss:0.4291593134403229 norm:0.06290869414806366 reconstruction:0.026064891200512648 attack:0.2277271520718932 margin:0.8768361375277164
[2025-10-12 23:44:02 root] (omniquant.py 347): INFO layer 19 iter 4 loss:0.4095418155193329 norm:0.05728789418935776 reconstruction:0.026408994253724814 attack:0.22677329301834107 margin:0.7817976463565469
[2025-10-12 23:44:10 root] (omniquant.py 225): INFO === Start quantize layer 20 ===
[2025-10-12 23:44:42 root] (omniquant.py 347): INFO layer 20 iter 0 loss:0.42792221903800964 norm:0.020966894924640656 reconstruction:0.03012900521978736 attack:0.23099831325933337 margin:0.8339743261176409
[2025-10-12 23:45:05 root] (omniquant.py 347): INFO layer 20 iter 1 loss:0.4257205128669739 norm:0.02042005956172943 reconstruction:0.03010275907814503 attack:0.22848670125938952 margin:0.8356553874648398
[2025-10-12 23:45:29 root] (omniquant.py 347): INFO layer 20 iter 2 loss:0.4239000082015991 norm:0.02053937502205372 reconstruction:0.030073094926774502 attack:0.22771875642240047 margin:0.83054073205858
[2025-10-12 23:45:52 root] (omniquant.py 347): INFO layer 20 iter 3 loss:0.4214516878128052 norm:0.020738918334245682 reconstruction:0.030060630291700363 attack:0.22652016169391573 margin:0.8243544680308287
[2025-10-12 23:46:15 root] (omniquant.py 347): INFO layer 20 iter 4 loss:0.4177437722682953 norm:0.021975865587592125 reconstruction:0.030051239505410193 attack:0.22429521668702365 margin:0.81698656924651
[2025-10-12 23:46:24 root] (omniquant.py 225): INFO === Start quantize layer 21 ===
[2025-10-12 23:46:55 root] (omniquant.py 347): INFO layer 21 iter 0 loss:0.4815375804901123 norm:0.01928829401731491 reconstruction:0.033982329610735176 attack:0.1893912185053341 margin:1.2908200855286782
[2025-10-12 23:47:18 root] (omniquant.py 347): INFO layer 21 iter 1 loss:0.4716114401817322 norm:0.01947624608874321 reconstruction:0.033992312513291836 attack:0.2062767478823662 margin:1.1567118338692057
[2025-10-12 23:47:42 root] (omniquant.py 347): INFO layer 21 iter 2 loss:0.46615365147590637 norm:0.02024189382791519 reconstruction:0.03398386038839817 attack:0.21421035837382077 margin:1.0897971699692426
[2025-10-12 23:48:06 root] (omniquant.py 347): INFO layer 21 iter 3 loss:0.46206414699554443 norm:0.021255603060126305 reconstruction:0.03399031735956669 attack:0.2206229290063493 margin:1.0372545225552836
[2025-10-12 23:48:29 root] (omniquant.py 347): INFO layer 21 iter 4 loss:0.4591788351535797 norm:0.021559078246355057 reconstruction:0.03400705449283123 attack:0.22918672497849912 margin:0.9799251379759517
[2025-10-12 23:48:37 root] (omniquant.py 225): INFO === Start quantize layer 22 ===
[2025-10-12 23:49:06 root] (omniquant.py 347): INFO layer 22 iter 0 loss:1.5894935131072998 norm:0.450002521276474 reconstruction:0.03845254773274064 attack:0.9676036757954717 margin:2.9171865137484563
[2025-10-12 23:49:29 root] (omniquant.py 347): INFO layer 22 iter 1 loss:0.8913165330886841 norm:0.6951611042022705 reconstruction:0.038597295228391885 attack:0.4655126794677926 margin:1.9360327655740548
[2025-10-12 23:49:51 root] (omniquant.py 347): INFO layer 22 iter 2 loss:0.6599524617195129 norm:0.6884506940841675 reconstruction:0.03886581007391214 attack:0.24889221953395463 margin:1.8609720343780645
[2025-10-12 23:50:14 root] (omniquant.py 347): INFO layer 22 iter 3 loss:0.6275172233581543 norm:0.6712072491645813 reconstruction:0.038991890475153924 attack:0.24378479981540294 margin:1.7237025025456751
[2025-10-12 23:50:37 root] (omniquant.py 347): INFO layer 22 iter 4 loss:0.5980378985404968 norm:0.6408986449241638 reconstruction:0.03911951284855604 attack:0.2397394440807693 margin:1.5958944990055897
[2025-10-12 23:50:44 root] (omniquant.py 225): INFO === Start quantize layer 23 ===
[2025-10-12 23:51:14 root] (omniquant.py 347): INFO layer 23 iter 0 loss:0.561112105846405 norm:0.020336806774139404 reconstruction:0.04438023786991835 attack:0.34896572231547907 margin:0.8388304872875897
[2025-10-12 23:51:37 root] (omniquant.py 347): INFO layer 23 iter 1 loss:0.5305827856063843 norm:0.015222395770251751 reconstruction:0.04431642096489668 attack:0.30614540832466447 margin:0.9006047124040196
[2025-10-12 23:51:59 root] (omniquant.py 347): INFO layer 23 iter 2 loss:0.5092963576316833 norm:0.014266425743699074 reconstruction:0.04427813347429037 attack:0.2719023294077488 margin:0.965579392274733
[2025-10-12 23:52:22 root] (omniquant.py 347): INFO layer 23 iter 3 loss:0.49671706557273865 norm:0.015034315176308155 reconstruction:0.04425025343894959 attack:0.23933934134140145 margin:1.0656373247595252
[2025-10-12 23:52:44 root] (omniquant.py 347): INFO layer 23 iter 4 loss:0.48727211356163025 norm:0.014574829488992691 reconstruction:0.04424795020371675 attack:0.22420313580601942 margin:1.0941052634668949
[2025-10-12 23:52:52 root] (omniquant.py 225): INFO === Start quantize layer 24 ===
[2025-10-12 23:53:21 root] (omniquant.py 347): INFO layer 24 iter 0 loss:0.5029874444007874 norm:0.040312834084033966 reconstruction:0.05006224747747183 attack:0.3455668363207951 margin:0.5367916596002238
[2025-10-12 23:53:44 root] (omniquant.py 347): INFO layer 24 iter 1 loss:0.46436625719070435 norm:0.033882543444633484 reconstruction:0.05004474066197872 attack:0.2921437969896942 margin:0.6108887130068615
[2025-10-12 23:54:06 root] (omniquant.py 347): INFO layer 24 iter 2 loss:0.4445825517177582 norm:0.03292831405997276 reconstruction:0.05004856251180172 attack:0.2465507413330488 margin:0.7399160281883087
[2025-10-12 23:54:29 root] (omniquant.py 347): INFO layer 24 iter 3 loss:0.4359945058822632 norm:0.032647743821144104 reconstruction:0.05016674760729074 attack:0.22519007026450708 margin:0.8031881358250393
[2025-10-12 23:54:51 root] (omniquant.py 347): INFO layer 24 iter 4 loss:0.4289599657058716 norm:0.03201533108949661 reconstruction:0.050300543308258054 attack:0.21618373402860017 margin:0.8123786220695968
[2025-10-12 23:54:59 root] (omniquant.py 225): INFO === Start quantize layer 25 ===
[2025-10-12 23:55:28 root] (omniquant.py 347): INFO layer 25 iter 0 loss:0.4493379294872284 norm:0.0130378482863307 reconstruction:0.05610027354210615 attack:0.30087011694908145 margin:0.46183779968172983
[2025-10-12 23:55:51 root] (omniquant.py 347): INFO layer 25 iter 1 loss:0.43328148126602173 norm:0.011988370679318905 reconstruction:0.05612059220671654 attack:0.2738568128505722 margin:0.5165203295510491
[2025-10-12 23:56:13 root] (omniquant.py 347): INFO layer 25 iter 2 loss:0.42071083188056946 norm:0.012214056216180325 reconstruction:0.05613456003367901 attack:0.24644523222465067 margin:0.5906550638572662
[2025-10-12 23:56:36 root] (omniquant.py 347): INFO layer 25 iter 3 loss:0.4142058491706848 norm:0.01213231310248375 reconstruction:0.05619085438549518 attack:0.22390424439683557 margin:0.6705538173954483
[2025-10-12 23:56:58 root] (omniquant.py 347): INFO layer 25 iter 4 loss:0.41015198826789856 norm:0.013101402670145035 reconstruction:0.056247627437114714 attack:0.2162164342822507 margin:0.688439541709522
[2025-10-12 23:57:05 root] (omniquant.py 225): INFO === Start quantize layer 26 ===
[2025-10-12 23:57:34 root] (omniquant.py 347): INFO layer 26 iter 0 loss:0.7587702870368958 norm:0.05227961391210556 reconstruction:0.06450843159109354 attack:0.5831602003797889 margin:0.5555084080864253
[2025-10-12 23:57:56 root] (omniquant.py 347): INFO layer 26 iter 1 loss:0.5485726594924927 norm:0.04074828699231148 reconstruction:0.06496271874755621 attack:0.40917043946683407 margin:0.3721974544825798
[2025-10-12 23:58:19 root] (omniquant.py 347): INFO layer 26 iter 2 loss:0.4130149185657501 norm:0.03209804743528366 reconstruction:0.06583040844649077 attack:0.22568428835831583 margin:0.6075010968954302
[2025-10-12 23:58:41 root] (omniquant.py 347): INFO layer 26 iter 3 loss:0.4061712324619293 norm:0.029834507033228874 reconstruction:0.06567025896161795 attack:0.21306025159545242 margin:0.6372036198939895
[2025-10-12 23:59:04 root] (omniquant.py 347): INFO layer 26 iter 4 loss:0.40180259943008423 norm:0.02934473752975464 reconstruction:0.06545449081808329 attack:0.211301186773926 margin:0.6252347059025565
[2025-10-12 23:59:11 root] (omniquant.py 225): INFO === Start quantize layer 27 ===
[2025-10-12 23:59:39 root] (omniquant.py 347): INFO layer 27 iter 0 loss:0.4242987036705017 norm:0.004279621411114931 reconstruction:0.07374692093580962 attack:0.2715718846023083 margin:0.3948996161911964
[2025-10-13 00:00:02 root] (omniquant.py 347): INFO layer 27 iter 1 loss:0.41745391488075256 norm:0.004470572341233492 reconstruction:0.07373782027512789 attack:0.25708428733050825 margin:0.43315887811608716
[2025-10-13 00:00:24 root] (omniquant.py 347): INFO layer 27 iter 2 loss:0.41047242283821106 norm:0.0047411685809493065 reconstruction:0.0737032064422965 attack:0.2419661458954215 margin:0.4740153989645478
[2025-10-13 00:00:47 root] (omniquant.py 347): INFO layer 27 iter 3 loss:0.40413910150527954 norm:0.005306178238242865 reconstruction:0.07366643641144037 attack:0.21903466051444412 margin:0.5571900396038746
[2025-10-13 00:01:09 root] (omniquant.py 347): INFO layer 27 iter 4 loss:0.4007592499256134 norm:0.005021735560148954 reconstruction:0.07359569691121579 attack:0.20860403842292727 margin:0.5927976070837758
[2025-10-13 00:01:16 root] (omniquant.py 225): INFO === Start quantize layer 28 ===
[2025-10-13 00:01:44 root] (omniquant.py 347): INFO layer 28 iter 0 loss:0.4457852840423584 norm:0.014947804622352123 reconstruction:0.08418210208415985 attack:0.2787059505470097 margin:0.4144862449086486
[2025-10-13 00:02:07 root] (omniquant.py 347): INFO layer 28 iter 1 loss:0.4313366711139679 norm:0.012906426563858986 reconstruction:0.08420798607170582 attack:0.24965354966931044 margin:0.48737573989172234
[2025-10-13 00:02:29 root] (omniquant.py 347): INFO layer 28 iter 2 loss:0.4224853515625 norm:0.012183103710412979 reconstruction:0.08413819156587124 attack:0.22831487817689777 margin:0.550161419432261
[2025-10-13 00:02:52 root] (omniquant.py 347): INFO layer 28 iter 3 loss:0.4169881343841553 norm:0.011708331294357777 reconstruction:0.08403115384280682 attack:0.21601406977511942 margin:0.5847145683960662
[2025-10-13 00:03:14 root] (omniquant.py 347): INFO layer 28 iter 4 loss:0.4136532247066498 norm:0.011405381374061108 reconstruction:0.08395888067781926 attack:0.20970742168836295 margin:0.5999347557964211
[2025-10-13 00:03:22 root] (omniquant.py 225): INFO === Start quantize layer 29 ===
[2025-10-13 00:03:49 root] (omniquant.py 347): INFO layer 29 iter 0 loss:0.4363393485546112 norm:0.006711940746754408 reconstruction:0.0956868663430214 attack:0.18156532872468234 margin:0.7954359775669217
[2025-10-13 00:04:11 root] (omniquant.py 347): INFO layer 29 iter 1 loss:0.43273431062698364 norm:0.006731629837304354 reconstruction:0.09555563054978848 attack:0.19124780816026032 margin:0.7296543173497457
[2025-10-13 00:04:33 root] (omniquant.py 347): INFO layer 29 iter 2 loss:0.4300471246242523 norm:0.006829365622252226 reconstruction:0.09542355686426163 attack:0.19698402859270572 margin:0.6881976135510558
[2025-10-13 00:04:55 root] (omniquant.py 347): INFO layer 29 iter 3 loss:0.42813602089881897 norm:0.007138835731893778 reconstruction:0.0952659598737955 attack:0.20131075024604797 margin:0.6577966305652808
[2025-10-13 00:05:17 root] (omniquant.py 347): INFO layer 29 iter 4 loss:0.4256431460380554 norm:0.00760938785970211 reconstruction:0.09505817107856274 attack:0.20499435833655297 margin:0.6279529079880013
[2025-10-13 00:05:23 root] (omniquant.py 225): INFO === Start quantize layer 30 ===
[2025-10-13 00:05:51 root] (omniquant.py 347): INFO layer 30 iter 0 loss:0.4737769663333893 norm:0.024304959923028946 reconstruction:0.14175655618309974 attack:0.22456889821216464 margin:0.5372575394441083
[2025-10-13 00:06:14 root] (omniquant.py 347): INFO layer 30 iter 1 loss:0.44957923889160156 norm:0.01131619792431593 reconstruction:0.11968290567398071 attack:0.2175274063460529 margin:0.5618446724727982
[2025-10-13 00:06:37 root] (omniquant.py 347): INFO layer 30 iter 2 loss:0.4467295706272125 norm:0.00951394159346819 reconstruction:0.1185904324054718 attack:0.2126853843498975 margin:0.5772687036579373
[2025-10-13 00:07:00 root] (omniquant.py 347): INFO layer 30 iter 3 loss:0.4448491036891937 norm:0.009183657355606556 reconstruction:0.11806440465152264 attack:0.20999209155328571 margin:0.5839626929532096
[2025-10-13 00:07:23 root] (omniquant.py 347): INFO layer 30 iter 4 loss:0.4427134394645691 norm:0.00941214244812727 reconstruction:0.11752965405583382 attack:0.20883751450106502 margin:0.5817313592438587
[2025-10-13 00:07:30 root] (omniquant.py 225): INFO === Start quantize layer 31 ===
[2025-10-13 00:07:58 root] (omniquant.py 347): INFO layer 31 iter 0 loss:1.7073771953582764 norm:0.04033325985074043 reconstruction:0.15574767291545868 attack:1.1016380310058593 margin:2.2499569122772662
[2025-10-13 00:08:21 root] (omniquant.py 347): INFO layer 31 iter 1 loss:1.1899946928024292 norm:0.0414808951318264 reconstruction:0.1539562849700451 attack:0.8055572514235974 margin:1.1524060141557129
[2025-10-13 00:08:43 root] (omniquant.py 347): INFO layer 31 iter 2 loss:0.47092264890670776 norm:0.018387818709015846 reconstruction:0.1521173783391714 attack:0.23930495105683802 margin:0.39750176719720004
[2025-10-13 00:09:06 root] (omniquant.py 347): INFO layer 31 iter 3 loss:0.4458732604980469 norm:0.014653043821454048 reconstruction:0.1473242513090372 attack:0.20671809162944554 margin:0.45915449425869154
[2025-10-13 00:09:28 root] (omniquant.py 347): INFO layer 31 iter 4 loss:0.43902188539505005 norm:0.01466943696141243 reconstruction:0.14480378344655037 attack:0.20502176240086556 margin:0.44598155288753333
[2025-10-13 00:09:36 root] (main.py 395): INFO 4081.5659732818604
[2025-10-13 00:09:38 root] (main.py 122): INFO load calibration from ./cache/testloader_Llama_wikitext2_all.cache
[2025-10-13 00:11:38 root] (main.py 166): INFO wikitext2 : 10.045421600341797
[2025-10-13 00:11:38 root] (main.py 122): INFO load calibration from ./cache/testloader_Llama_c4_all.cache
[2025-10-13 00:12:38 root] (main.py 166): INFO c4 : 12.272476196289062
